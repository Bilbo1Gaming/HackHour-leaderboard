<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.16/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://unpkg.com/bun"></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-4">
        <h1 class="text-3xl font-bold mb-4">Leaderboard</h1>

        <!-- Add User Form -->
        <div id="addUserForm">
            <label for="slack_id" class="block mb-1">Slack ID:</label>
            <input type="text" id="slack_id" placeholder="Enter Slack ID" class="border border-gray-300 rounded-md p-2 w-full mb-2">

            <label for="username" class="block mb-1">Username:</label>
            <input type="text" id="username" placeholder="Enter Username" class="border border-gray-300 rounded-md p-2 w-full mb-2">

            <button onclick="addUser()" class="bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600">Add User</button>
        </div>

        <!-- Leaderboard Table -->
        <table id="leaderboardTable" class="min-w-full bg-white shadow-md rounded-lg overflow-hidden">
            <thead class="bg-gray-800 text-white">
                <tr>
                    <th class="py-2 px-4">Rank</th>
                    <th class="py-2 px-4">Username</th>
                    <th class="py-2 px-4">Sessions</th>
                </tr>
            </thead>
            <tbody id="leaderboardBody">
                <!-- Leaderboard rows will be populated dynamically -->
            </tbody>
        </table>
    </div>

    <script>
        const bun = new Bun();

        function addUser() {
            const slackId = document.getElementById('slack_id').value;
            const username = document.getElementById('username').value;

            // Simulating form submission to a backend (replace with actual API call)
            const newUser = { slack_id: slackId, username: username, sessions: 0 }; // Assuming sessions start at 0
            bun.emit('addUser', newUser);
        }

        // Listen for new user addition events
        bun.on('addUser', newUser => {
            // Add logic here to update backend or local storage with new user
            // For now, let's assume we update the leaderboard immediately
            updateLeaderboard();
        });

        // Function to update leaderboard (simulated with static data)
        function updateLeaderboard() {
            const users = [
                { username: 'User1', sessions: 10 },
                { username: 'User2', sessions: 8 },
                { username: 'User3', sessions: 15 },
                // Add more users as needed
            ];

            const leaderboardBody = document.getElementById('leaderboardBody');
            leaderboardBody.innerHTML = ''; // Clear existing rows

            users.forEach((user, index) => {
                const row = `<tr class="${index % 2 === 0 ? 'bg-gray-100' : 'bg-white'}">
                    <td class="py-2 px-4">${index + 1}</td>
                    <td class="py-2 px-4">${user.username}</td>
                    <td class="py-2 px-4">${user.sessions}</td>
                </tr>`;
                leaderboardBody.innerHTML += row;
            });
        }

        // Initial leaderboard update
        updateLeaderboard();
    </script>
</body>
</html>
